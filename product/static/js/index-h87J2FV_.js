var c=(m,g,r)=>new Promise((p,a)=>{var U=i=>{try{w(r.next(i))}catch(_){a(_)}},V=i=>{try{w(r.throw(i))}catch(_){a(_)}},w=i=>i.done?p(i.value):Promise.resolve(i.value).then(U,V);w((r=r.apply(m,g)).next())});import{j as z,d as P,k as j,a as F,r as Q,m as G,n as H,o as b,c as D,e as t,w as d,u as e,p as S,q as x,E as k,h as f,t as v,s as L,v as I,F as J,x as K,y as W,z as X,i as C}from"./index-CzvhIu7P.js";import{E as Y,a as Z,b as h,g as ee}from"./role-O-svaULO.js";import{E as ae,a as q,b as y,c as te,d as le}from"./index-rrQgjpCY.js";import{E as u,a as R}from"./index-KErNApeX.js";import{E}from"./index-BDDkVizw.js";const se="_container_zgovq_1",de={container:se},re=m=>z.get("/admin-api/system/adminUser",m),oe=m=>z.post("/admin-api/system/adminUser",m),ne=m=>z.get(`/admin-api/system/adminUser/${m}`),ie=(m,g)=>z.put(`/admin-api/system/adminUser/${m}`,g),be=P({name:"systemAdmin",__name:"index",setup(m){const{t:g}=j(),r=F({name:"",email:"",page:1,pageSize:10}),p=F({list:[],total:0,page:1,pageSize:10}),a=F({visible:!1,data:{name:"",nickname:"",email:"",password:"",status:!0},title:"编辑管理员",roleList:[],type:"add",rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:16,message:"长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱号",trigger:"blur"},{type:"email",message:"请输入正确的邮箱号",trigger:"blur"}],nickname:[{min:2,max:16,message:"长度在 2 到 16 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}]}}),U=Q();G(()=>{V()});const V=()=>c(this,null,function*(){var l,n;const o=yield re(r);o.code===200?(p.list=((l=o.data)==null?void 0:l.list)||[],p.total=((n=o.data)==null?void 0:n.total)||0):(p.list=[],p.total=0)}),w=()=>c(this,null,function*(){const o=yield ee();o.code===200?a.roleList=o.data:a.roleList=[]}),i=()=>c(this,null,function*(){V()}),_=()=>{a.type="add",w(),a.visible=!0,a.title="新增管理员",A()},A=()=>{a.data={name:"",nickname:"",email:"",password:"",status:!0}},T=o=>{r.page=o,V()},B=o=>c(this,null,function*(){const l=yield ne(o);l.code===200?(a.visible=!0,a.type="edit",a.title="编辑管理员",a.data=l.data,w()):C.error(l.msg)}),$=()=>c(this,null,function*(){var o;(o=U.value)==null||o.validate(l=>c(this,null,function*(){if(l){if(a.type==="add"){const n=yield oe(a.data);n.code===200?(a.visible=!1,A(),i(),C.success("新增成功")):C.error(n.msg)}else if(a.type==="edit"&&a.data.id){const n=yield ie(a.data.id,a.data);n.code===200?(a.visible=!1,A(),i(),C.success("修改成功")):C.error(n.msg)}}}))}),M=()=>{r.name="",r.email="",r.page=1,r.pageSize=10,a.visible=!1,A(),V()},N=o=>c(this,null,function*(){});return(o,l)=>{const n=H("permission");return b(),D("div",{class:X(["container",e(de).container])},[t(e(R),{model:r},{default:d(()=>[t(e(ae),{gutter:24},{default:d(()=>[t(e(q),{span:24},{default:d(()=>[S((b(),x(e(k),{type:"primary",onClick:_},{default:d(()=>[f(v(e(g)("button.add")),1)]),_:1})),[[n,["system:admin:add"]]])]),_:1}),t(e(q),{xs:24,sm:12,md:8,lg:6,xl:6},{default:d(()=>[t(e(u),{label:"用户名"},{default:d(()=>[t(e(E),{modelValue:r.name,"onUpdate:modelValue":l[0]||(l[0]=s=>r.name=s),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1})]),_:1}),t(e(q),{xs:24,sm:12,md:8,lg:6,xl:6},{default:d(()=>[t(e(u),{label:"邮箱号"},{default:d(()=>[t(e(E),{modelValue:r.email,"onUpdate:modelValue":l[1]||(l[1]=s=>r.email=s),placeholder:"请输入邮箱号"},null,8,["modelValue"])]),_:1})]),_:1}),t(e(q),{xs:24,sm:12,md:8,lg:6,xl:6},{default:d(()=>[t(e(u),null,{default:d(()=>[t(e(k),{type:"primary",onClick:i},{default:d(()=>[f(v(e(g)("button.submit")),1)]),_:1}),t(e(k),{onClick:M},{default:d(()=>[f(v(e(g)("button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),t(e(te),{data:p.list,border:""},{default:d(()=>[t(e(y),{label:"ID",prop:"id",align:"center"}),t(e(y),{label:"用户名",prop:"name",align:"center"}),t(e(y),{label:"昵称",prop:"nickname",align:"center"}),t(e(y),{label:"邮箱号",prop:"email",align:"center"}),t(e(y),{label:"创建时间",prop:"createdAt",align:"center"},{default:d(s=>[f(v(e(L)(s.row.createdAt)),1)]),_:1}),t(e(y),{label:"更新时间",prop:"updatedAt",align:"center"},{default:d(s=>[f(v(e(L)(s.row.updatedAt)),1)]),_:1}),t(e(y),{label:"操作",align:"center"},{default:d(s=>[S((b(),x(e(k),{text:"",onClick:O=>B(s.row.id)},{default:d(()=>l[9]||(l[9]=[f("编辑")])),_:2},1032,["onClick"])),[[n,["system:admin:edit"]]]),s.row.id!==1?S((b(),x(e(k),{key:0,type:"danger",text:"",onClick:O=>N(s.row.id)},{default:d(()=>l[10]||(l[10]=[f("删除")])),_:2},1032,["onClick"])),[[n,["system:admin:del"]]]):I("",!0)]),_:1})]),_:1},8,["data"]),p.total>r.pageSize?(b(),x(e(Y),{key:0,layout:"prev, pager, next",total:p.total,"page-size":r.pageSize,"current-page":r.page,onCurrentChange:T},null,8,["total","page-size","current-page"])):I("",!0),t(e(le),{modelValue:a.visible,"onUpdate:modelValue":l[8]||(l[8]=s=>a.visible=s),title:a.title,"append-to-body":""},{default:d(()=>[t(e(R),{ref_key:"dialogFormRef",ref:U,model:a.data,rules:a.rules,"label-width":"100px"},{default:d(()=>[t(e(u),{label:"用户名",prop:"name",required:""},{default:d(()=>[t(e(E),{modelValue:a.data.name,"onUpdate:modelValue":l[2]||(l[2]=s=>a.data.name=s)},null,8,["modelValue"])]),_:1}),t(e(u),{label:"昵称",prop:"nickname"},{default:d(()=>[t(e(E),{modelValue:a.data.nickname,"onUpdate:modelValue":l[3]||(l[3]=s=>a.data.nickname=s)},null,8,["modelValue"])]),_:1}),t(e(u),{label:"邮箱号",prop:"email",required:""},{default:d(()=>[t(e(E),{modelValue:a.data.email,"onUpdate:modelValue":l[4]||(l[4]=s=>a.data.email=s)},null,8,["modelValue"])]),_:1}),t(e(u),{label:"密码",prop:"password",required:a.type==="add"},{default:d(()=>[t(e(E),{modelValue:a.data.password,"onUpdate:modelValue":l[5]||(l[5]=s=>a.data.password=s),modelModifiers:{trim:!0},type:"password",autocomplete:"new-password"},null,8,["modelValue"])]),_:1},8,["required"]),t(e(u),{label:"角色",prop:"roleId"},{default:d(()=>[t(e(Z),{modelValue:a.data.roleId,"onUpdate:modelValue":l[6]||(l[6]=s=>a.data.roleId=s),placeholder:"请选择角色"},{default:d(()=>[(b(!0),D(J,null,K(a.roleList,s=>(b(),x(e(h),{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(e(u),{label:"状态",prop:"status"},{default:d(()=>[t(e(W),{modelValue:a.data.status,"onUpdate:modelValue":l[7]||(l[7]=s=>a.data.status=s)},null,8,["modelValue"])]),_:1}),t(e(u),null,{default:d(()=>[t(e(k),{type:"primary",onClick:$},{default:d(()=>[f(v(e(g)("button.submit")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],2)}}});export{be as default};
